<!DOCTYPE html>
<html lang="en-us">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="theme" content="hugo-academic">
  <meta name="generator" content="Hugo 0.31.1" />
  <meta name="author" content="Silas Bergen">
  <meta name="description" content="Assistant professor of statistics and data science">

  
  <link rel="alternate" hreflang="en-us" href="http://driftlessdata.space/courses/dsci310/intro_to_ggplot2/">

  
  


  

  
  
  
  
    
  
  
    
    
      
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
      
    
  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha512-6MXa8B6uaO18Hid6blRMetEIoPqHf7Ux1tnyIQdpt9qI5OACx7C+O3IVTr98vwGnlcg0LOLa02i9Y1HpVhlfiw==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.1/css/academicons.min.css" integrity="sha512-NThgw3XKQ1absAahW6to7Ey42uycrVvfNfyjqcFNgCmOCQ5AR4AO0SiXrN+8ZtYeappp56lk1WtvjVmEa+VR6A==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha512-SfTiTlX6kk+qitfevl/7LibUOeJWlt9rbyDn92a1DqWOw9vWG2MFoays0sgObmWazO5BQPiFucnnEAjpAB+/Sw==" crossorigin="anonymous">
  
  
  
  
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Montserrat:400,700%7cRoboto:400,400italic,700%7cRoboto&#43;Mono">
  
  <link rel="stylesheet" href="/styles.css">
  

  
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-111127083-1', 'auto');
      ga('require', 'eventTracker');
      ga('require', 'outboundLinkTracker');
      ga('require', 'urlChangeTracker');
      ga('send', 'pageview');
    </script>
    <script async src="//www.google-analytics.com/analytics.js"></script>
    
    <script async src="https://cdnjs.cloudflare.com/ajax/libs/autotrack/2.4.1/autotrack.js" integrity="sha512-HUmooslVKj4m6OBu0OgzjXXr+QuFYy/k7eLI5jdeEy/F4RSgMn6XRWRGkFi5IFaFgy7uFTkegp3Z0XnJf3Jq+g==" crossorigin="anonymous"></script>
    
  

  
  <link rel="alternate" href="http://driftlessdata.space/index.xml" type="application/rss+xml" title="Driftless Data">
  <link rel="feed" href="http://driftlessdata.space/index.xml" type="application/rss+xml" title="Driftless Data">
  

  <link rel="manifest" href="/site.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="http://driftlessdata.space/courses/dsci310/intro_to_ggplot2/">

  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="og:site_name" content="Driftless Data">
  <meta property="og:url" content="http://driftlessdata.space/courses/dsci310/intro_to_ggplot2/">
  <meta property="og:title" content="Introduction to data visualization in R using ggplot2 | Driftless Data">
  <meta property="og:description" content="">
  <meta property="og:locale" content="en-us">
  
  <meta property="article:published_time" content="2017-10-09T00:00:00&#43;00:00">
  
  <meta property="article:modified_time" content="2017-10-09T00:00:00&#43;00:00">
  

  

  <title>Introduction to data visualization in R using ggplot2 | Driftless Data</title>

</head>
<body id="top" data-spy="scroll" data-target="#toc" data-offset="71" >

<nav class="navbar navbar-default navbar-fixed-top" id="navbar-main">
  <div class="container">

    
    <div class="navbar-header">
      
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
              data-target=".navbar-collapse" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      
      <a class="navbar-brand" href="/">Driftless Data</a>
    </div>

    
    <div class="collapse navbar-collapse">

      
      
      <ul class="nav navbar-nav navbar-left">
        

        

        
          
        

        <li class="nav-item">
          <a href="/#about">
            
            <span>Home</span>
            
          </a>
        </li>

        
        

        

        
          
        

        <li class="nav-item">
          <a href="/#teaching">
            
            <span>Teaching</span>
            
          </a>
        </li>

        
        

        

        
          
        

        <li class="nav-item">
          <a href="/#posts">
            
            <span>Posts</span>
            
          </a>
        </li>

        
        

        

        
          
        

        <li class="nav-item">
          <a href="/#talks">
            
            <span>Presentations</span>
            
          </a>
        </li>

        
        

        

        
          
        

        <li class="nav-item">
          <a href="/#projects">
            
            <span>Projects</span>
            
          </a>
        </li>

        
        

        

        
          
        

        <li class="nav-item">
          <a href="/#contact">
            
            <span>Contact &amp; Office Hours</span>
            
          </a>
        </li>

        
        
      

      
      </ul>

    </div>
  </div>
</nav>


<article class="article" itemscope itemtype="http://schema.org/Article">

  


  <div class="article-container">
    <div class="article-inner">
      <h1 itemprop="name">Introduction to data visualization in R using ggplot2</h1>

      

<div class="article-metadata">

  <span class="article-date">
    
    <time datetime="2017-10-09 00:00:00 &#43;0000 UTC" itemprop="datePublished">
      Oct 9, 2017
    </time>
  </span>

  

  
  

  

  
  

  

</div>


      <div class="article-style" itemprop="articleBody">
        <div id="overview" class="section level2">
<h2>Overview</h2>
<div id="basic-grammar" class="section level3">
<h3>Basic grammar</h3>
<p>Hadley’s Grammar of Graphics is outlined in detail in <a href="http://vita.had.co.nz/papers/layered-grammar.pdf">this article</a>. Here, he illustrates his principles using a small data set similar to the following:</p>
<pre class="r"><code>df &lt;- data.frame(A = c(2,1,4,9),
                 B  = c(4,1,15,80),
                 C = c(1,2,3,4),
                 D = c(&#39;far&#39;,&#39;far&#39;,&#39;near&#39;,&#39;near&#39;))
head(df)</code></pre>
<pre><code>##   A  B C    D
## 1 2  4 1  far
## 2 1  1 2  far
## 3 4 15 3 near
## 4 9 80 4 near</code></pre>
<p>To visualize any data set using the Grammar of Graphics, it helps to understand the 3 components of which any graph is comprised:</p>
<ol style="list-style-type: decimal">
<li>Geoms</li>
<li>Scales</li>
<li>Data columns</li>
</ol>
<p><strong>Geoms</strong> are the visual entities that we see on a graph. In the image below, we see three examples of geoms: a circular <strong><em>point</em></strong>, a <strong><em>bar</em></strong>, and a <strong><em>line</em></strong>:</p>
<div class="figure">
<img src="img/geoms.PNG" />

</div>
<p><strong>Scales</strong> control how the <strong>data columns</strong> map to the aesthetic attributes of the geoms. For example, is the point geom <em>yellow</em> or <em>blue</em>? Is it <em>large</em> or <em>small</em>? Is it <em>high</em> or <em>low</em>? <em>Left</em> or <em>right</em>? These aesthetic attributes are respectively controlled by the <strong>color</strong>, <strong>size</strong>, <strong>y</strong>, and <strong>x</strong> scales:</p>
<div class="figure">
<img src="img/scales.PNG" />

</div>
<p>Additional scales in <code>ggplot2</code> are:</p>
<ul>
<li><strong>shape</strong></li>
<li><strong>linetype</strong> (for the line geom)</li>
<li><strong>fill</strong> (for the bar and point geoms)</li>
</ul>
<p>Any plot created with <code>ggplot2</code> requires these ingredients. To create a plot, one must specify the desired geom; which data variables are to be aesthetically mapped to the geom; and the scales to use to control the mapping. The skeleton of any <code>ggplot2</code> command is as follows; parts in italics are to be replaced with specific data variable names, geoms, and scales:</p>
<p><strong>ggplot(data = <em>nameofdata</em>) + geom_<em>nameofgeom</em>(aes(<em>scale1</em> = <em>variable1</em>, <em>scale2</em> = <em>variable2</em>))</strong></p>
<p>At a minimum, most geoms require the <code>x</code> scale.</p>
<p>Begin by loading the package (installing first if never done before):</p>
<pre class="r"><code>library(ggplot2)</code></pre>
<p>Let’s begin by mapping <code>A</code> and <code>B</code> to the <code>point</code> geom on a Cartesian plane. Note in <code>?geom_point</code> that two scales are required for aesthetic mappings to point geoms:</p>
<pre class="r"><code>ggplot(data = df) + geom_point(aes(x = A,y=B))</code></pre>
<p><img src="/courses/dsci310/Intro_to_ggplot2_files/figure-html/unnamed-chunk-3-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>We can employ other scales outside of aesthetic mappings. For example, if we want to change the aesthetic mapping of the above scatterplot by changing the <strong>shape</strong>, <strong>color</strong>, and <strong>size</strong> scale, we can do so with the following:</p>
<pre class="r"><code>ggplot(data = df) + geom_point(aes(x = A,y=B), shape = 17,color=&#39;red&#39;,size=4)</code></pre>
<p><img src="/courses/dsci310/Intro_to_ggplot2_files/figure-html/unnamed-chunk-4-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>Notice in the above code that the scales that are not controlling aesthetic data mappings are <em>outside</em> the <code>aes()</code> command.</p>
<p>As an aside, looking at the <code>?shape</code> help file, we can find code to see all possible shapes:</p>
<pre class="r"><code>df2 &lt;- data.frame(x = 1:5 , y = 1:25, z = 1:25)
s &lt;- ggplot(df2, aes(x = x, y = y))
s + geom_point(aes(shape = z), size = 4) + scale_shape_identity()</code></pre>
<p><img src="/courses/dsci310/Intro_to_ggplot2_files/figure-html/unnamed-chunk-5-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>Now suppose we want to aesthetically map other variables using the <strong>shape</strong>, <strong>color</strong>, and <strong>size</strong> scales. We must now put these specifications inside the <code>aes()</code> command and specify the variables we wish to map. Consider the following code, and note the different looks, error messages and warnings that appear when attempting to apply aesthetic mappings using various scales depending on the data type. In <code>ggplot</code>-speak, “continuous” refers to quantitative data in general; while “discrete” refers to categorical data:</p>
<pre class="r"><code>#Mapping continuous C with size:
ggplot(data = df) + geom_point(aes(x = A,y=B, size = C))
#Mapping continuous C with size and color:
ggplot(data = df) + geom_point(aes(x = A,y=B, size = C, color = C))
#Mapping continuous C with shape (we know we shouldn&#39;t do this!):
ggplot(data = df) + geom_point(aes(x = A,y=B, shape = C))</code></pre>
<p><img src="/courses/dsci310/Intro_to_ggplot2_files/figure-html/unnamed-chunk-7-1.png" width="432" /><img src="/courses/dsci310/Intro_to_ggplot2_files/figure-html/unnamed-chunk-7-2.png" width="432" /></p>
<p><strong>YOUR TURN</strong>: See if you can re-create these plots:</p>
<p><img src="/courses/dsci310/Intro_to_ggplot2_files/figure-html/unnamed-chunk-8-1.png" width="432" /><img src="/courses/dsci310/Intro_to_ggplot2_files/figure-html/unnamed-chunk-8-2.png" width="432" /><img src="/courses/dsci310/Intro_to_ggplot2_files/figure-html/unnamed-chunk-8-3.png" width="432" /><img src="/courses/dsci310/Intro_to_ggplot2_files/figure-html/unnamed-chunk-8-4.png" width="432" /></p>
<p>Note some interesting concepts illustrated here:</p>
<ul>
<li><em>Continuous</em> variables should be mapped using <strong>size</strong> or <strong>color</strong> scales; these are the scales/EPTs that can encode quantity.</li>
<li><em>Discrete</em> variables should be mapped with <strong>shape</strong> or <strong>color</strong> scales; these are the scales/EPTs that are best used for indicating “categories.”</li>
</ul>
</div>
<div id="layers" class="section level3">
<h3>Layers</h3>
<p>A very important aspect of the <code>ggplot2</code> package is the idea of <em>layers</em>. Aesthetic mappings to different geoms can take place simply by specifying additional mappings with a <code>+</code> sign. For example, suppose we want to create the above scatterplots with points <em>and</em> lines. This requires two aesthetic mappings: one from the data to the points geom, and one from the data to the lines geom. We can see this in what follows. Note that because both <code>geom_point()</code> and <code>geom_line()</code> rely on the same aesthetic mapping, we could simplify the code by specifiying the appropriate mapping in the initial <code>ggplot()</code> command. The following two lines of code are equivalent:</p>
<pre class="r"><code>ggplot(data = df) + geom_point(aes(x = A,y=B), size = 4) + geom_line(aes(x = A,y=B))
ggplot(aes(x = A, y = B), data = df) + geom_point(size = 4) + geom_line()</code></pre>
<p><img src="/courses/dsci310/Intro_to_ggplot2_files/figure-html/unnamed-chunk-10-1.png" width="432" style="display: block; margin: auto;" /></p>
<p><strong>TASK:</strong> Re-create the following plots. What happens if you try to map variable <code>C</code> to <code>geom_line()</code> using the <strong>size</strong> scale?</p>
<p><img src="/courses/dsci310/Intro_to_ggplot2_files/figure-html/unnamed-chunk-11-1.png" width="432" /><img src="/courses/dsci310/Intro_to_ggplot2_files/figure-html/unnamed-chunk-11-2.png" width="432" /><img src="/courses/dsci310/Intro_to_ggplot2_files/figure-html/unnamed-chunk-11-3.png" width="432" /><img src="/courses/dsci310/Intro_to_ggplot2_files/figure-html/unnamed-chunk-11-4.png" width="432" /></p>
</div>
<div id="facets" class="section level3">
<h3>Facets</h3>
<p><em>Faceting</em>, according to Wickham, is “a more general case of the techniques known as conditioning, trellising, and latticing, and produces small multiples showing different subsets of the data” (page 6). This conditioning is done by way of the <code>facet_grid()</code> argument using formula, <code>~</code>, syntax:</p>
<pre class="r"><code>ggplot(aes(x = A,y=B),data = df)  + geom_line(size=2)+ geom_point(size = 4) + facet_grid(.~D)
ggplot(aes(x = A,y=B),data = df)  + geom_line(size=2)+ geom_point(size = 4) + facet_grid(D~.)</code></pre>
<p><img src="/courses/dsci310/Intro_to_ggplot2_files/figure-html/unnamed-chunk-13-1.png" width="432" /><img src="/courses/dsci310/Intro_to_ggplot2_files/figure-html/unnamed-chunk-13-2.png" width="432" /></p>
<p>The easiest way to change the labels is to change the levels of the <code>D</code> factor:</p>
<pre class="r"><code>levels(df$D)</code></pre>
<pre><code>## [1] &quot;far&quot;  &quot;near&quot;</code></pre>
<pre class="r"><code>levels(df$D) &lt;- c(&#39;Away&#39;,&#39;Home&#39;)
ggplot(aes(x = A,y=B, color=D),data = df)  + geom_line(size=2)+ geom_point(size = 4) + facet_grid(.~D)</code></pre>
<p><img src="/courses/dsci310/Intro_to_ggplot2_files/figure-html/unnamed-chunk-14-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>Changing the labels without changing the underlying data requires use of a <code>labeller</code> function, with is not exactly intuitive.</p>
</div>
<div id="bells-and-whistles" class="section level3">
<h3>Bells and whistles</h3>
<p>Titles and axis labels are easily modified by way of the <code>ggtitle()</code>, <code>xlab()</code>, and <code>ylab()</code> commands. Legend titles and labels are a little less intuitive, and require thought as to the <strong>scale</strong> that is being shown, and the variable type that is being mapped. Changing these is by way of the <code>scale_*_*()</code> function, where the first <code>*</code> is the scale type and the second <code>*</code> is the type of the variable being mapped.</p>
<p>For example, suppose we want to change the default legend name and labels of the following graph: <img src="/courses/dsci310/Intro_to_ggplot2_files/figure-html/unnamed-chunk-15-1.png" width="432" style="display: block; margin: auto;" /></p>
<p>There are <em>two</em> scales involved in this visualization: <strong>shape</strong> and <strong>color</strong>, and they are being used to map a <em>discrete</em> variable. Hence to modify the legend we should use <code>scale_shape_discrete()</code> and <code>scale_color_discrete()</code>. Note that if we only modify one at a time, two legends will appear reflecting the different modifications; this is not desirable. The names and labels must be identical for the two legends to merge:</p>
<pre class="r"><code>ggplot(data = df) + geom_point(aes(x = A,y=B, shape = D,color=D), size = 4) + 
    scale_shape_discrete(name=&#39;Variable D&#39;)
ggplot(data = df) + geom_point(aes(x = A,y=B, shape = D,color=D), size = 4) + 
    scale_color_discrete(labels=c(&#39;TweedleDee&#39;,&#39;TweedleDum&#39;))
ggplot(data = df) + geom_point(aes(x = A,y=B, shape = D,color=D), size = 4) + 
    scale_color_discrete(name=&#39;Variable D&#39;,labels=c(&#39;TweedleDee&#39;,&#39;TweedleDum&#39;)) + 
    scale_shape_discrete(name=&#39;Variable D&#39;,labels=c(&#39;TweedleDee&#39;,&#39;TweedleDum&#39;)) + 
    xlab(&#39;Variable A&#39;) + ylab(&#39;Variable B&#39;) + ggtitle(&quot;Here&#39;s a sweet title&quot;)</code></pre>
<p><img src="/courses/dsci310/Intro_to_ggplot2_files/figure-html/unnamed-chunk-17-1.png" width="432" /><img src="/courses/dsci310/Intro_to_ggplot2_files/figure-html/unnamed-chunk-17-2.png" width="432" /><img src="/courses/dsci310/Intro_to_ggplot2_files/figure-html/unnamed-chunk-17-3.png" width="432" /></p>
</div>
</div>

      </div>

      

    </div>
  </div>

</article>






<div class="article-container">
  

</div>

<footer class="site-footer">
  <div class="container">
    <p class="powered-by">

      &copy; 2017 Silas Bergen &middot; 

      Powered by the
      <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
      <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

      <span class="pull-right" aria-hidden="true">
        <a href="#" id="back_to_top">
          <span class="button_icon">
            <i class="fa fa-chevron-up fa-2x"></i>
          </span>
        </a>
      </span>

    </p>
  </div>
</footer>


<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close btn-large" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Cite</h4>
      </div>
      <div>
        <pre><code class="modal-body tex"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-primary btn-outline js-copy-cite" href="#" target="_blank">
          <i class="fa fa-copy"></i> Copy
        </a>
        <a class="btn btn-primary btn-outline js-download-cite" href="#" target="_blank">
          <i class="fa fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

    

    
    

    

    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js" integrity="sha512-3P8rXCuGJdNZOnUx/03c1jOTnMn3rP63nBip5gOP2qmUh5YAdVAvFZ1E+QLZZbC1rtMrQb+mah3AfYW11RUrWA==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.3/imagesloaded.pkgd.min.js" integrity="sha512-umsR78NN0D23AzgoZ11K7raBD+R6hqKojyBZs1w8WvYlsI+QuKRGBx3LFCwhatzBunCjDuJpDHwxD13sLMbpRA==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha512-iztkobsvnjKfAtTNdHkGVjAYTrrtlC7mGp/54c40wowO7LhURYl3gVzzcEqGl/qKXQltJ2HwMrdLcNUdo+N/RQ==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.4/isotope.pkgd.min.js" integrity="sha512-VDBOIlDbuC4VWxGJNmuFRQ0Li0SKkDpmGyuhAG5LTDLd/dJ/S0WMVxriR2Y+CyPL5gzjpN4f/6iqWVBJlht0tQ==" crossorigin="anonymous"></script>
    
    
    <script src="/js/hugo-academic.js"></script>
    

    
    
      
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script>
      

      

      

      <script>hljs.initHighlightingOnLoad();</script>
    

    
    
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] } });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_CHTML" integrity="sha512-tOav5w1OjvsSJzePRtt2uQPFwBoHt1VZcUq8l8nm5284LEKE9FSJBQryzMBzHxY5P0zRdNqEcpLIRVYFNgu1jw==" crossorigin="anonymous"></script>
    
    

  </body>
</html>

