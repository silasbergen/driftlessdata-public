<!DOCTYPE html>
<html lang="en-us">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="theme" content="hugo-academic">
  <meta name="generator" content="Hugo 0.48" />
  <meta name="author" content="Silas Bergen">
  <meta name="description" content="Assistant professor of statistics and data science">

  
  <link rel="alternate" hreflang="en-us" href="http://driftlessdata.space/courses/stat450/r_hw2/">

  
  


  

  
  
  
  
    
  
  
    
    
      
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
      
    
  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha512-6MXa8B6uaO18Hid6blRMetEIoPqHf7Ux1tnyIQdpt9qI5OACx7C+O3IVTr98vwGnlcg0LOLa02i9Y1HpVhlfiw==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.1/css/academicons.min.css" integrity="sha512-NThgw3XKQ1absAahW6to7Ey42uycrVvfNfyjqcFNgCmOCQ5AR4AO0SiXrN+8ZtYeappp56lk1WtvjVmEa+VR6A==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha512-SfTiTlX6kk+qitfevl/7LibUOeJWlt9rbyDn92a1DqWOw9vWG2MFoays0sgObmWazO5BQPiFucnnEAjpAB+/Sw==" crossorigin="anonymous">
  
  
  
  
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Montserrat:400,700%7cRoboto:400,400italic,700%7cRoboto&#43;Mono">
  
  <link rel="stylesheet" href="/styles.css">
  

  
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-111127083-1', 'auto');
      ga('require', 'eventTracker');
      ga('require', 'outboundLinkTracker');
      ga('require', 'urlChangeTracker');
      ga('send', 'pageview');
    </script>
    <script async src="//www.google-analytics.com/analytics.js"></script>
    
    <script async src="https://cdnjs.cloudflare.com/ajax/libs/autotrack/2.4.1/autotrack.js" integrity="sha512-HUmooslVKj4m6OBu0OgzjXXr+QuFYy/k7eLI5jdeEy/F4RSgMn6XRWRGkFi5IFaFgy7uFTkegp3Z0XnJf3Jq+g==" crossorigin="anonymous"></script>
    
  

  
  <link rel="alternate" href="http://driftlessdata.space/index.xml" type="application/rss+xml" title="Silas Bergen">
  <link rel="feed" href="http://driftlessdata.space/index.xml" type="application/rss+xml" title="Silas Bergen">
  

  <link rel="manifest" href="/site.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="http://driftlessdata.space/courses/stat450/r_hw2/">

  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="og:site_name" content="Silas Bergen">
  <meta property="og:url" content="http://driftlessdata.space/courses/stat450/r_hw2/">
  <meta property="og:title" content="R Homework 2 | Silas Bergen">
  <meta property="og:description" content="">
  <meta property="og:locale" content="en-us">
  
  
  
  

  

  <title>R Homework 2 | Silas Bergen</title>

</head>
<body id="top" data-spy="scroll" data-target="#toc" data-offset="71" >

<nav class="navbar navbar-default navbar-fixed-top" id="navbar-main">
  <div class="container">

    
    <div class="navbar-header">
      
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
              data-target=".navbar-collapse" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      
      <a class="navbar-brand" href="/">Silas Bergen</a>
    </div>

    
    <div class="collapse navbar-collapse">

      
      
      <ul class="nav navbar-nav navbar-left">
        

        

        
          
        

        <li class="nav-item">
          <a href="/#about">
            
            <span>Home</span>
            
          </a>
        </li>

        
        

        

        
          
        

        <li class="nav-item">
          <a href="/#teaching">
            
            <span>Teaching</span>
            
          </a>
        </li>

        
        

        

        
          
        

        <li class="nav-item">
          <a href="/#posts">
            
            <span>Posts</span>
            
          </a>
        </li>

        
        

        

        
          
        

        <li class="nav-item">
          <a href="/#talks">
            
            <span>Presentations</span>
            
          </a>
        </li>

        
        

        

        
          
        

        <li class="nav-item">
          <a href="/#projects">
            
            <span>Projects</span>
            
          </a>
        </li>

        
        

        

        
          
        

        <li class="nav-item">
          <a href="/#contact">
            
            <span>Contact &amp; Office Hours</span>
            
          </a>
        </li>

        
        
      

      
      </ul>

    </div>
  </div>
</nav>


<article class="article" itemscope itemtype="http://schema.org/Article">

  


  <div class="article-container">
    <div class="article-inner">
      <h1 itemprop="name">R Homework 2</h1>

      

<div class="article-metadata">

  <span class="article-date">
    
    <time datetime="0001-01-01 00:00:00 &#43;0000 UTC" itemprop="datePublished">
      Jan 1, 0001
    </time>
  </span>

  

  
  

  

  
  

  

</div>


      <div class="article-style" itemprop="articleBody">
        <p><strong>Due Wednesday, 9/20 by 11:59pm. Prepare your submission with R Markdown. Submit fully-knitted html, Word, or pdf to D2L by due date. You are encouraged to use this .Rmd file as your starting point for your submission.</strong></p>
<p>(Modified from <em>Introduction to Scientific Programming and Simulation Using R</em> by Owen Jones et al).</p>
<p>A roulette wheel has 37 slots. 18 of these are colored red, 18 are black, and 1 slot (numbered 0) is colored green. The red and black slots are numbered from 1 to 36. There are four possible “games” or “systems” you can use when playing roulette. Different games offer different playing experiences. Some allow you to win more often than you lose, some let you play longer, some cost more to play, and some risk greater losses for a greater reward. The games we will consider here are as follows.</p>
<p>A. <strong><em>Betting on red</em></strong></p>
<p>This game involves a single bet. You always bet on red, and you always bet $1. If the ball lands on red you win $1, otherwise you lose.</p>
<p>B. <strong><em>Betting on a number</em></strong></p>
<p>This game also involves a single bet. You bet $1 on a single number, say 17. If the ball lands on that number you win $35, otherwise you lose.</p>
<p>C. <strong><em>Martingale system</em></strong></p>
<p>In this game you start by betting $1 on red. If you lose, you double your previous bet; if you win, your next bet is $1. Regardless, you continue to bet on red. The game continues until your net winnings equal $10, or the bet exceeds $100 (you only have a finite amount of wealth!).</p>
<p>D. <strong><em>Labouchere System</em></strong></p>
<p>In this game you start with the list of numbers (1,2,3,4). To begin, you bet the sum of the first and last numbers on red (initially, $5). If you win you delete the first and last numbers from the list (so if you win the list becomes (2,3)), otherwise you add the loss to the end of the list (so if you lose your first bet the list becomes (1,2,3,4,5)). Repeat until your list is empty, or the bet exceeds $100. If only one number is left on the list, you bet that number.</p>
<p>E. <strong><em>Fibonacci System</em></strong></p>
<p>This system is intended to use Nature to win Money. The Fibonacci Sequence are the numbers:</p>
<p>0, 1, 1, 2, 3, 5, 8, 13, 21, 34…</p>
<p>In this sequence, each number is the sum of the preceding two numbers.</p>
<p>To use the Fibonacci System, you always bet on red. Your first bet is the first non-zero number in the sequence, $ %&gt;% 1. If you lose, you bet the next number in the sequence, and continue moving along the sequence as long as you continue losing. If you win, you revert to the previous number in the sequence for your next bet.</p>
<p>An example, with the bet number; bet amount; and bet outcome:</p>
<ul>
<li>Bet 1: $1; loss.</li>
<li>Bet 2: $1; loss.</li>
<li>Bet 3: $2; loss.</li>
<li>Bet 4: $3; loss.</li>
<li>Bet 5: $5; win.</li>
<li>Bet 6: $3; loss.<br />
…etc.</li>
</ul>
<p>You continue to play until your next bet is $0; or your next bet would exceed $100.</p>
<p>Thus the following game would be complete:</p>
<ul>
<li>Bet 1: $1; loss.</li>
<li>Bet 2: $1; win (move back to the “first” 1)</li>
<li>Bet 3: $1; win</li>
</ul>
<p>Game over, since your next bet would be $0.</p>
<p>Games C-E are intended to cover previous losses by increasing bet size.</p>
<p>The purpose of this problem is to compare the following qualities of the four games:</p>
<ol style="list-style-type: decimal">
<li>Expected winnings per game;</li>
<li>Proportion of games you win (i.e., make money);</li>
<li>Expected playing time per game, measured by the number of bets made;</li>
<li>The maximum amount you can win;</li>
<li>The maximum amount you can lose.</li>
</ol>
<div id="part-1-theoretical" class="section level3">
<h3>Part 1: Theoretical</h3>
<p>I. For the first four games, find the theoretical values of the maximum amount you could win in a single play of the game. (This amount is very difficult to determine for Game E). Enter these in the table below.</p>
<table>
<thead>
<tr class="header">
<th>Game</th>
<th>(4) Max win</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td></td>
</tr>
<tr class="even">
<td>B</td>
<td></td>
</tr>
<tr class="odd">
<td>C</td>
<td></td>
</tr>
<tr class="even">
<td>D</td>
<td></td>
</tr>
</tbody>
</table>
<ol start="2" style="list-style-type: upper-roman">
<li>For all games, find the theoretical values of the maximum amount you could lose in a single play of the game. Enter these in the table below.</li>
</ol>
<table>
<thead>
<tr class="header">
<th>Game</th>
<th>(5) Max loss</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td></td>
</tr>
<tr class="even">
<td>B</td>
<td></td>
</tr>
<tr class="odd">
<td>C</td>
<td></td>
</tr>
<tr class="even">
<td>D</td>
<td></td>
</tr>
<tr class="odd">
<td>E</td>
<td></td>
</tr>
</tbody>
</table>
</div>
<div id="part-2-simulation" class="section level3">
<h3>Part 2: Simulation</h3>
<p>For each game write a function (with no arguments) that plays the game once and returns a vector of length 2 consisting of the amount won/lost and how many bets were made. Using these functions and the <code>replicate()</code> function, simulate 100,000 “playings” of each game. For Games C-E, you may want to consider the use of a <code>while()</code> loop. Fill in the table below with your simulated results, verifying that columns 4 and 5 are similar to the theoretical (if they are not, something is wrong with your functions!)</p>
<table style="width:96%;">
<colgroup>
<col width="5%" />
<col width="18%" />
<col width="18%" />
<col width="18%" />
<col width="18%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th>Game</th>
<th>(1) Expected winnings</th>
<th>(2) Proportion of games won</th>
<th>(3) Expected playing time</th>
<th>(4) Max win</th>
<th>(5) Max loss</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>B</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>C</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>D</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>E</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>Additionally, using <code>sd()</code> and the results of your 100,000 “playings” of each game, answer the following questions:</p>
<ul>
<li>For which game is the amount won most variable?</li>
<li>For which game is the expected playing time most variable?</li>
</ul>
<p>To get you started, here is the shell of a function for Game C. Similarly for Games D-E, you will need to set initial values of bet, money, and nplays. Set the <code>while()</code> loop condition–and update the values of <code>bet</code>, <code>money</code>, and <code>nplays</code>– according to the rules of each game.</p>
<pre class="r"><code>gameC &lt;- function() {
  bet &lt;- 1
  money &lt;- 0
  nplays &lt;- 0
  while(money &lt;  10 &amp; bet &lt;= 100) {
    #Spin the wheel, record outcome (win or loss)
    #Update money depending on wheel outcome
    #Update bet depending on wheel outcome
    #Update nplays
  }
  return(c(money,nplays))
}</code></pre>
</div>

      </div>

      

    </div>
  </div>

</article>






<div class="article-container">
  

</div>

<footer class="site-footer">
  <div class="container">
    <p class="powered-by">

      &copy; 2017 Silas Bergen &middot; 

      Powered by the
      <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
      <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

      <span class="pull-right" aria-hidden="true">
        <a href="#" id="back_to_top">
          <span class="button_icon">
            <i class="fa fa-chevron-up fa-2x"></i>
          </span>
        </a>
      </span>

    </p>
  </div>
</footer>


<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close btn-large" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Cite</h4>
      </div>
      <div>
        <pre><code class="modal-body tex"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-primary btn-outline js-copy-cite" href="#" target="_blank">
          <i class="fa fa-copy"></i> Copy
        </a>
        <a class="btn btn-primary btn-outline js-download-cite" href="#" target="_blank">
          <i class="fa fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

    

    
    

    

    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js" integrity="sha512-3P8rXCuGJdNZOnUx/03c1jOTnMn3rP63nBip5gOP2qmUh5YAdVAvFZ1E+QLZZbC1rtMrQb+mah3AfYW11RUrWA==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.3/imagesloaded.pkgd.min.js" integrity="sha512-umsR78NN0D23AzgoZ11K7raBD+R6hqKojyBZs1w8WvYlsI+QuKRGBx3LFCwhatzBunCjDuJpDHwxD13sLMbpRA==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha512-iztkobsvnjKfAtTNdHkGVjAYTrrtlC7mGp/54c40wowO7LhURYl3gVzzcEqGl/qKXQltJ2HwMrdLcNUdo+N/RQ==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.4/isotope.pkgd.min.js" integrity="sha512-VDBOIlDbuC4VWxGJNmuFRQ0Li0SKkDpmGyuhAG5LTDLd/dJ/S0WMVxriR2Y+CyPL5gzjpN4f/6iqWVBJlht0tQ==" crossorigin="anonymous"></script>
    
    
    <script src="/js/hugo-academic.js"></script>
    

    
    
      
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script>
      

      

      

      <script>hljs.initHighlightingOnLoad();</script>
    

    
    
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] } });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_CHTML" integrity="sha512-tOav5w1OjvsSJzePRtt2uQPFwBoHt1VZcUq8l8nm5284LEKE9FSJBQryzMBzHxY5P0zRdNqEcpLIRVYFNgu1jw==" crossorigin="anonymous"></script>
    
    

  </body>
</html>

